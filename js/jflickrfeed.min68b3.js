(function(a){a.fn.jflickrfeed=function(d,f){d=a.extend(true,{flickrbase:"http://api.flickr.com/services/feeds/",feedapi:"photos_public.gne",limit:20,qstrings:{lang:"en-us",format:"json",jsoncallback:"?"},cleanDescription:true,useTemplate:true,itemTemplate:"",itemCallback:function(){}},d);var b=d.flickrbase+d.feedapi+"?";var e=true;for(var c in d.qstrings){if(!e){b+="&"}b+=c+"="+d.qstrings[c];e=false}return a(this).each(function(){var h=a(this);var g=this;a.getJSON(b,function(i){a.each(i.items,function(m,p){if(m<d.limit){if(d.cleanDescription){var o=/<p>(.*?)<\/p>/g;var j=p.description;if(o.test(j)){p.description=j.match(o)[2];if(p.description!=undefined){p.description=p.description.replace("<p>","").replace("</p>","")}}}p.image_s=p.media.m.replace("_m","_s");p.image_t=p.media.m.replace("_m","_t");p.image_m=p.media.m.replace("_m","_m");p.image=p.media.m.replace("_m","");p.image_b=p.media.m.replace("_m","_b");delete p.media;if(d.useTemplate){var n=d.itemTemplate;for(var l in p){var k=new RegExp("{{"+l+"}}","g");n=n.replace(k,p[l])}h.append(n)}d.itemCallback.call(g,p)}});if(a.isFunction(f)){f.call(g,i)}})})}})(jQuery);