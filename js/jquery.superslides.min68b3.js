/*! Superslides - v0.6.3-wip - 2013-12-17
* https://github.com/nicinabox/superslides
* Copyright (c) 2013 Nic Aitch; Licensed MIT */
(function(c,d){var a,b="superslides";a=function(e,n){this.options=d.extend({play:false,animation_speed:600,animation_easing:"swing",animation:"slide",inherit_width_from:c,inherit_height_from:c,pagination:true,hashchange:false,scrollable:true,elements:{preserve:".preserve",nav:".slides-navigation",container:".slides-container",pagination:".slides-pagination"}},n);var j=this,l=d("<div>",{"class":"slides-control"}),m=1;this.$el=d(e);this.$container=this.$el.find(this.options.elements.container);var h=function(){m=j._findMultiplier();j.$el.on("click",j.options.elements.nav+" a",function(o){o.preventDefault();j.stop();if(d(this).hasClass("next")){j.animate("next",function(){j.start()})}else{j.animate("prev",function(){j.start()})}});d(document).on("keyup",function(o){if(o.keyCode===37){j.animate("prev")}if(o.keyCode===39){j.animate("next")}});d(c).on("resize",function(){setTimeout(function(){var o=j.$container.children();j.width=j._findWidth();j.height=j._findHeight();o.css({width:j.width,left:j.width});j.css.containers();j.css.images()},10)});if(j.options.hashchange){d(c).on("hashchange",function(){var p=j._parseHash(),o;o=j._upcomingSlide(p);if(o>=0&&o!==j.current){j.animate(o)}})}j.pagination._events();j.start();return j};var i={containers:function(){if(j.init){j.$el.css({height:j.height});j.$control.css({width:j.width*m,left:-j.width});j.$container.css({})}else{d("body").css({margin:0});j.$el.css({position:"relative",overflow:"hidden",width:"100%",height:j.height});j.$control.css({position:"relative",transform:"translate3d(0)",height:"100%",width:j.width*m,left:-j.width});j.$container.css({display:"none",margin:"0",padding:"0",listStyle:"none",position:"relative",height:"100%"})}if(j.size()===1){j.$el.find(j.options.elements.nav).hide()}},images:function(){var o=j.$container.find("img").not(j.options.elements.preserve);o.removeAttr("width").removeAttr("height").css({"-webkit-backface-visibility":"hidden","-ms-interpolation-mode":"bicubic",position:"absolute",left:"0",top:"0","z-index":"-1","max-width":"none"});o.each(function(){var q=j.image._aspectRatio(this),r=this;if(!d.data(this,"processed")){var p=new Image();p.onload=function(){j.image._scale(r,q);j.image._center(r,q);d.data(r,"processed",true)};p.src=this.src}else{j.image._scale(r,q);j.image._center(r,q)}})},children:function(){var o=j.$container.children();if(o.is("img")){o.each(function(){if(d(this).is("img")){d(this).wrap("<div>");var p=d(this).attr("id");d(this).removeAttr("id");d(this).parent().attr("id",p)}});o=j.$container.children()}if(!j.init){o.css({display:"none",left:j.width*2})}o.css({position:"absolute",overflow:"hidden",height:"100%",width:j.width,top:0,zIndex:0})}};var g={slide:function(r,p){var q=j.$container.children(),o=q.eq(r.upcoming_slide);o.css({left:r.upcoming_position,display:"block"});j.$control.animate({left:r.offset},j.options.animation_speed,j.options.animation_easing,function(){if(j.size()>1){j.$control.css({left:-j.width});q.eq(r.upcoming_slide).css({left:j.width,zIndex:2});if(r.outgoing_slide>=0){q.eq(r.outgoing_slide).css({left:j.width,display:"none",zIndex:0})}}p()})},fade:function(r,p){var s=this,q=s.$container.children(),t=q.eq(r.outgoing_slide),o=q.eq(r.upcoming_slide);o.css({left:this.width,opacity:0,display:"block"}).animate({opacity:1},s.options.animation_speed,s.options.animation_easing);if(r.outgoing_slide>=0){t.animate({opacity:0},s.options.animation_speed,s.options.animation_easing,function(){if(s.size()>1){q.eq(r.upcoming_slide).css({zIndex:2});if(r.outgoing_slide>=0){q.eq(r.outgoing_slide).css({opacity:1,display:"none",zIndex:0})}}p()})}else{o.css({zIndex:2});p()}}};g=d.extend(g,d.fn.superslides.fx);var f={_centerY:function(p){var o=d(p);o.css({top:(j.height-o.height())/2})},_centerX:function(p){var o=d(p);o.css({left:(j.width-o.width())/2})},_center:function(o){j.image._centerX(o);j.image._centerY(o)},_aspectRatio:function(p){if(!p.naturalHeight&&!p.naturalWidth){var o=new Image();o.src=p.src;p.naturalHeight=o.height;p.naturalWidth=o.width}return p.naturalHeight/p.naturalWidth},_scale:function(q,p){p=p||j.image._aspectRatio(q);var r=j.height/j.width,o=d(q);if(r>p){o.css({height:j.height,width:j.height/p})}else{o.css({height:j.width*p,width:j.width})}}};var k={_setCurrent:function(p){if(!j.$pagination){return}var o=j.$pagination.children();o.removeClass("current");o.eq(p).addClass("current")},_addItem:function(q){var t=q+1,p=t,r=j.$container.children().eq(q),s=r.attr("id");if(s){p=s}var o=d("<a>",{href:"#"+p,text:p});o.appendTo(j.$pagination)},_setup:function(){if(!j.options.pagination||j.size()===1){return}var o=d("<nav>",{"class":j.options.elements.pagination.replace(/^\./,"")});j.$pagination=o.appendTo(j.$el);for(var p=0;p<j.size();p++){j.pagination._addItem(p)}},_events:function(){j.$el.on("click",j.options.elements.pagination+" a",function(q){q.preventDefault();var p=j._parseHash(this.hash),o;o=j._upcomingSlide(p,true);if(o!==j.current){j.animate(o,function(){j.start()})}})}};this.css=i;this.image=f;this.pagination=k;this.fx=g;this.animation=this.fx[this.options.animation];this.$control=this.$container.wrap(l).parent(".slides-control");j._findPositions();j.width=j._findWidth();j.height=j._findHeight();this.css.children();this.css.containers();this.css.images();this.pagination._setup();return h()};a.prototype={_findWidth:function(){return d(this.options.inherit_width_from).width()},_findHeight:function(){return d(this.options.inherit_height_from).height()},_findMultiplier:function(){return this.size()===1?1:3},_upcomingSlide:function(g,f){if(f&&!isNaN(g)){g=g-1}if((/next/).test(g)){return this._nextInDom()}else{if((/prev/).test(g)){return this._prevInDom()}else{if((/\d/).test(g)){return +g}else{if(g&&(/\w/).test(g)){var e=this._findSlideById(g);if(e>=0){return e}else{return 0}}else{return 0}}}}},_findSlideById:function(e){return this.$container.find("#"+e).index()},_findPositions:function(f,e){e=e||this;if(f===undefined){f=-1}e.current=f;e.next=e._nextInDom();e.prev=e._prevInDom()},_nextInDom:function(){var e=this.current+1;if(e===this.size()){e=0}return e},_prevInDom:function(){var e=this.current-1;if(e<0){e=this.size()-1}return e},_parseHash:function(e){e=e||c.location.hash;e=e.replace(/^#/,"");if(e&&!isNaN(+e)){e=+e}return e},size:function(){return this.$container.children().length},destroy:function(){return this.$el.removeData()},update:function(){this.css.children();this.css.containers();this.css.images();this.pagination._addItem(this.size());this._findPositions(this.current);this.$el.trigger("updated.slides")},stop:function(){clearInterval(this.play_id);delete this.play_id;this.$el.trigger("stopped.slides")},start:function(){var e=this;if(e.options.hashchange){d(c).trigger("hashchange")}else{this.animate()}if(this.options.play){if(this.play_id){this.stop()}this.play_id=setInterval(function(){e.animate()},this.options.play)}this.$el.trigger("started.slides")},animate:function(i,e){var g=this,f={};if(this.animating){return}this.animating=true;if(i===undefined){i="next"}f.upcoming_slide=this._upcomingSlide(i);if(f.upcoming_slide>=this.size()){return}f.outgoing_slide=this.current;f.upcoming_position=this.width*2;f.offset=-f.upcoming_position;if(i==="prev"||i<f.outgoing_slide){f.upcoming_position=0;f.offset=0}if(g.size()>1){g.pagination._setCurrent(f.upcoming_slide)}if(g.options.hashchange){var h=f.upcoming_slide+1,j=g.$container.children(":eq("+f.upcoming_slide+")").attr("id");if(j){c.location.hash=j}else{c.location.hash=h}}g.$el.trigger("animating.slides",[f]);g.animation(f,function(){g._findPositions(f.upcoming_slide,g);if(typeof e==="function"){e()}g.animating=false;g.$el.trigger("animated.slides");if(!g.init){g.$el.trigger("init.slides");g.init=true;g.$container.fadeIn("fast")}})}};d.fn[b]=function(g,f){var e=[];this.each(function(){var j,i,h;j=d(this);i=j.data(b);h=typeof g==="object"&&g;if(!i){e=j.data(b,(i=new a(this,h)))}if(typeof g==="string"){e=i[g];if(typeof e==="function"){return e=e.call(i,f)}}});return e};d.fn[b].fx={}})(this,jQuery);